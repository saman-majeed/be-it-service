<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('partials/head') %>
        <title>Be IT:Service Checkout</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/checkout.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <span class="d-inline-flex align-items-center">
                    <span class="bubble">Be</span> IT:SERVICE
                </span>
            </a>
            <a href="/" class="btn btn-sm btn-outline-light">Continue Shopping</a>
        </div>
    </nav>

    <div class="container checkout-box">
        <div id="alertBox"></div>
        <h3 class="section-title">Your Cart</h3>

        <table class="table align-middle">
            <thead>
                <tr>
                    <th>Service / Product</th>
                    <th class="text-end">Price</th>
                </tr>
            </thead>
            <tbody>
                <% if (cart.length> 0) { %>
                    <% cart.forEach(item=> { %>
                        <tr>
                            <td class="d-flex align-items-center">
                                <div
                                    style="width: 50px; height: 50px; background: #f0fdf4; color: #4cb050; border-radius: 8px; display: grid; place-content: center; font-size: 24px; margin-right: 15px;">
                                    <i class="<%= item.iconClass %>"></i>
                                </div>
                                <span>
                                    <%= item.name %>
                                </span>
                            </td>
                            <td class="text-end">$<%= item.price %>
                            </td>
                        </tr>
                        <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="2" class="text-center py-4 text-muted">
                                        Your cart is empty. <a href="/">Go add some services!</a>
                                    </td>
                                </tr>
                                <% } %>
            </tbody>
        </table>

        <h3 class="section-title">Order Summary</h3>
        <ul class="list-group mb-4">
            <li class="list-group-item d-flex justify-content-between">
                <span>Subtotal</span><strong>$<%= total %></strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
                <span>Handling Fee</span><strong>$10</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between text-success fw-bold">
                <span>Total</span><strong>$<%= total + 10 %></strong>
            </li>
        </ul>

        <% if (cart.length> 0) { %>
            <div class="d-flex justify-content-end mb-4">
                <a href="/clear-cart" class="text-danger small text-decoration-none">Clear Cart</a>
            </div>
            <% } %>

                <h3 class="section-title">Contact & Service Details</h3>
                <form id="checkoutForm" action="/process-order" method="POST">
                    <div class="mb-3">
                        <label class="form-label">Device Drop-off/Pickup Address</label>
                        <input type="text" id="address" name="address" class="form-control"
                            placeholder="Enter your address for service" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Primary Contact Number</label>
                        <input type="text" id="contact" name="contact" class="form-control"
                            placeholder="e.g., +1 555 123 4567" required>
                    </div>

                    <h3 class="section-title">Payment Method</h3>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="payment" id="cod" value="cod" checked>
                        <label class="form-check-label" for="cod">Pay on Delivery</label>
                    </div>
                    <div class="form-check mb-4">
                        <input class="form-check-input" type="radio" name="payment" id="online" value="online">
                        <label class="form-check-label" for="online">Pay Online Now</label>
                    </div>

                    <a href="/payment" class="btn btn-theme w-100 mb-2">Proceed to Online Payment</a>
                    <button type="submit" class="btn btn-theme w-100" id="placeOrderBtn">
                        Confirm Service Booking ($<%= total + 10 %>)
                    </button>
                </form>
    </div>

    <div class="modal fade" id="orderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">âœ… Service Booked!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <p class="fs-5">Your booking is confirmed.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-theme" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>